{
  "description": "The `friendli_core._hooks` subsystem provides a robust extension mechanism for the Friendli SDK. The `FriendliClient` initiates this by providing custom logic to the `HookRegistrar`, which then configures the `SDKHookOrchestrator`. This orchestrator is central to the subsystem, managing and invoking various hook types—defined by `HookDefinitions`—at critical junctures. For instance, the `HttpClient` triggers hooks before sending requests and after receiving responses, while the `SDKErrorProcessor` activates specific hooks when exceptions occur. This design allows for flexible customization of SDK behavior without altering its core implementation, enhancing adaptability and maintainability.",
  "components": [
    {
      "name": "FriendliClient",
      "description": "The primary interface for users to interact with the SDK and register custom extensions. Initializes the SDK and provides custom hook implementations to the `HookRegistrar`.",
      "referenced_source_code": [
        {
          "qualified_name": "friendli_core.FriendliClient",
          "reference_file": "src/friendli_core/sdk.py",
          "reference_start_line": null,
          "reference_end_line": null
        }
      ],
      "assigned_files": [],
      "can_expand": true
    },
    {
      "name": "HookRegistrar",
      "description": "The component responsible for receiving and organizing custom hook implementations. Receives custom hook instances from `FriendliClient` and adds them to the `SDKHookOrchestrator` for later invocation.",
      "referenced_source_code": [
        {
          "qualified_name": "friendli_core._hooks.registration.init_hooks",
          "reference_file": "src/friendli_core/_hooks/registration.py",
          "reference_start_line": 8,
          "reference_end_line": 12
        }
      ],
      "assigned_files": [
        "src/friendli_core/_hooks/registration.py"
      ],
      "can_expand": true
    },
    {
      "name": "SDKHookOrchestrator",
      "description": "The central component that manages the lifecycle of hooks, invoking them at appropriate stages of SDK operations. Stores and manages different types of hooks. It is responsible for invoking the correct hooks (e.g., `before_request`, `after_success`, `after_error`) when triggered by `HttpClient` or `SDKErrorProcessor`, ensuring they adhere to `HookDefinitions`.",
      "referenced_source_code": [
        {
          "qualified_name": "friendli_core._hooks.sdkhooks.SDKHooks",
          "reference_file": "src/friendli_core/_hooks/sdkhooks.py",
          "reference_start_line": 22,
          "reference_end_line": 79
        }
      ],
      "assigned_files": [
        "src/friendli_core/_hooks/sdkhooks.py"
      ],
      "can_expand": true
    },
    {
      "name": "HookDefinitions",
      "description": "The collection of abstract interfaces and data structures that define the contract and context for all types of hooks. Defines the abstract base classes for various hook types (e.g., `SDKInitHook`, `BeforeRequestHook`) and their associated context objects, establishing the API for custom extensions.",
      "referenced_source_code": [
        {
          "qualified_name": "friendli_core._hooks.types.Hooks",
          "reference_file": "src/friendli_core/_hooks/types.py",
          "reference_start_line": 100,
          "reference_end_line": 115
        },
        {
          "qualified_name": "friendli_core._hooks.types.SDKInitHook",
          "reference_file": "src/friendli_core/_hooks/types.py",
          "reference_start_line": 67,
          "reference_end_line": 70
        },
        {
          "qualified_name": "friendli_core._hooks.types.BeforeRequestHook",
          "reference_file": "src/friendli_core/_hooks/types.py",
          "reference_start_line": 73,
          "reference_end_line": 78
        },
        {
          "qualified_name": "friendli_core._hooks.types.AfterSuccessHook",
          "reference_file": "src/friendli_core/_hooks/types.py",
          "reference_start_line": 81,
          "reference_end_line": 86
        },
        {
          "qualified_name": "friendli_core._hooks.types.AfterErrorHook",
          "reference_file": "src/friendli_core/_hooks/types.py",
          "reference_start_line": 89,
          "reference_end_line": 97
        },
        {
          "qualified_name": "friendli_core._hooks.types.HookContext",
          "reference_file": "src/friendli_core/_hooks/types.py",
          "reference_start_line": 12,
          "reference_end_line": 31
        }
      ],
      "assigned_files": [
        "src/friendli_core/_hooks/types.py"
      ],
      "can_expand": false
    },
    {
      "name": "HttpClient",
      "description": "The underlying mechanism for making external network requests, which integrates with the hook system. Executes network requests. Before sending a request, it notifies the `SDKHookOrchestrator` to run `before_request` hooks. After receiving a response, it notifies the `SDKHookOrchestrator` to run `after_success` hooks.",
      "referenced_source_code": [
        {
          "qualified_name": "friendli_core.httpclient.HttpClient",
          "reference_file": "src/friendli_core/httpclient.py",
          "reference_start_line": 11,
          "reference_end_line": 47
        }
      ],
      "assigned_files": [],
      "can_expand": false
    },
    {
      "name": "SDKErrorProcessor",
      "description": "The part of the SDK responsible for handling exceptions and triggering error-specific hooks. Catches and processes exceptions during SDK operations. Upon an error, it notifies the `SDKHookOrchestrator` to run `after_error` hooks.",
      "referenced_source_code": [
        {
          "qualified_name": "friendli_core.SDKErrorProcessor",
          "reference_file": "src/friendli_core/models/sdkerror.py",
          "reference_start_line": 12,
          "reference_end_line": 39
        }
      ],
      "assigned_files": [],
      "can_expand": true
    },
    {
      "name": "Unclassified",
      "description": "Component for all unclassified files and utility functions (Utility functions/External Libraries/Dependencies)",
      "referenced_source_code": [],
      "assigned_files": [
        "src/friendli_core/_hooks/__init__.py"
      ],
      "can_expand": false
    }
  ],
  "components_relations": [
    {
      "relation": "implements",
      "src_name": "SDKHookOrchestrator",
      "dst_name": "HookDefinitions"
    },
    {
      "relation": "configures",
      "src_name": "HookRegistrar",
      "dst_name": "SDKHookOrchestrator"
    },
    {
      "relation": "uses",
      "src_name": "SDKHookOrchestrator",
      "dst_name": "HookDefinitions"
    },
    {
      "relation": "registers hooks with",
      "src_name": "FriendliClient",
      "dst_name": "HookRegistrar"
    },
    {
      "relation": "registers hooks with",
      "src_name": "HookRegistrar",
      "dst_name": "SDKHookOrchestrator"
    },
    {
      "relation": "invokes before_request hooks on",
      "src_name": "HttpClient",
      "dst_name": "SDKHookOrchestrator"
    },
    {
      "relation": "invokes after_success hooks on",
      "src_name": "HttpClient",
      "dst_name": "SDKHookOrchestrator"
    },
    {
      "relation": "invokes after_error hooks on",
      "src_name": "SDKErrorProcessor",
      "dst_name": "SDKHookOrchestrator"
    }
  ]
}
